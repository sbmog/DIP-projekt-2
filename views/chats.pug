include includes/header

body#chatpage
  h1 Chat oversigt

  div.action-buttons
    // Link til at oprette en ny chat
    if userLvl >=2
      a.create-btn(href="./chats/create") Opret ny chat

    if userLvl == 3
      a.create-btn(href="/users") Administrer brugere
    
    if isLoggedIn
       a.logoutbtn(href="/logout") Log ud
    else 
      a.create-btn(href="/") Log ind

  ul#chatList
    if chats.length > 0
      each chat in chats
        li.chat-item
          a.chat-link(href=`/chats/${chat.id}`) #{chat.name}
          if userLvl === 3 || (userLvl >= 2 && chat.user === userId)
              a.delete-chat-btn(href="javascript:void(0)", onclick=`deleteChat(${chat.id})`) ğŸ—‘ï¸
    else
      p Ingen chats fundet.
script.
    async function deleteChat(chatId) {
      if (!confirm('Er du sikker pÃ¥, at du vil slette denne chat?')) return
      const response = await fetch('/chats/' + chatId, {
        method: 'DELETE'
      });
      if (response.ok) {
        window.location.reload();
      } else {
        alert('Der skete en fejl. Kunne ikke slette chatten.')
      }
    }